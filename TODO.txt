fix rendering to use reworked state shape
add STEP_BACKWARD

